<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>♡えむしの無限延長ツール♡</title>
<style>
body{font-family:sans-serif;padding:18px}
h1{margin:0 0 8px}
#display p{margin:3px 0;font-size:1.05em}
button{padding:5px 9px;margin:2px;font-size:.9em;cursor:pointer}
.neg{background:#f8d7da}
.btns{margin:6px 0 8px}
.ctrl{margin:10px 0 12px;border:1px dashed #ccc;padding:8px}
input[type=text]{padding:4px 6px;width:110px}
.small{font-size:.85em;opacity:.75}
</style>
</head>
<body>

<h1>♡えむしの無限延長ツール♡</h1>

<div id="display" style="margin-bottom:8px;">
  <p>延長時間:
    <span id="extensionTime" style="font-variant-numeric:tabular-nums">00:00:00</span>
  </p>
  <p>配信時間:
    <span id="startTime">19:09:00</span> →
    <span id="timeDisplay" style="font-weight:bold">21:00:00</span>
  </p>
</div>

<!-- 途中からテキトーに編集できるやつ -->
<div class="ctrl">
  <div style="margin-bottom:6px">
    開始時刻(適当にHH:MM:SS)：<input id="startInput" type="text" value="19:09:00">
    <button id="setStartBtn">開始時刻を反映</button>
    <span class="small"></span>
  </div>
  <div>
    延長時間(適当にHH:MM:SS)：<input id="extInput" type="text" value="00:00:00">
    <button id="setExtBtn">延長時間を反映</button>
    <span class="small"></span>
  </div>
</div>

<div class="btns" id="addButtons"><!-- 足す --></div>
<div class="btns" id="subButtons"><!-- 引く --></div>

<script>
var PTS=[1,5,10,100,200,300,500,700,800,1000,2000,3000,5000,7000,10000,30000];
var totalSec=0, START_H=19, START_M=9, START_S=0;
var $ext=document.getElementById('extensionTime'), $end=document.getElementById('timeDisplay'), $start=document.getElementById('startTime');

// ユーティリティ？
function pad(n){n=n|0;return(n<10?'0':'')+n}
function toHMS(sec){var h=Math.floor(sec/3600);sec%=3600;var m=Math.floor(sec/60),s=sec%60;return pad(h)+':'+pad(m)+':'+pad(s)}
function parseHMS(str){
  if(!str){return {h:0,m:0,s:0}}
  var a=(str+'').split(':'); 
  var h=+a[0]||0,m=+a[1]||0,s=+a[2]||0;
  if(a.length===2){ s=m; m=h%60; h=Math.floor(h/60) } 
  if(h<0||m<0||s<0){h=0;m=0;s=0} 
  return {h:h|0,m:m|0,s:s|0}
}
function hmsToSec(o){return (o.h|0)*3600+(o.m|0)*60+(o.s|0)}

// 表示更新
function upd(){
  $ext.textContent = toHMS(totalSec);
  var base=new Date(); base.setHours(START_H,START_M,START_S,0);
  var end=new Date(base.getTime()+totalSec*1000);
  $end.textContent = pad(end.getHours())+':'+pad(end.getMinutes())+':'+pad(end.getSeconds());
  // 一応開始時刻の表示も更新
  $start.textContent = pad(START_H)+':'+pad(START_M)+':'+pad(START_S);
}

// ボタン量産
(function(){
  var add=document.getElementById('addButtons'), sub=document.getElementById('subButtons');
  var aH='', sH='';
  for(var i=0;i<PTS.length;i++){
    var p=PTS[i];
    aH+='<button data-p="'+p+'">+'+p+'pt</button>';
    sH+='<button class="neg" data-m="'+p+'">-'+p+'pt</button>';
  }
  add.innerHTML=aH; sub.innerHTML=sH;

  // デリゲーション
  add.onclick=function(e){
    var t=e.target||e.srcElement, v=t.getAttribute('data-p');
    if(v!=null){ totalSec += (v|0); upd(); }
  };
  sub.onclick=function(e){
    var t=e.target||e.srcElement, v=t.getAttribute('data-m');
    if(v!=null){ totalSec -= (v|0); if(totalSec<0) totalSec=0; upd(); }
  };
})();

// 反映ボタン（開始時刻）
document.getElementById('setStartBtn').onclick=function(){
  var str=document.getElementById('startInput').value;
  var o=parseHMS(str);
  START_H = (o.h|0)%24; START_M = (o.m|0)%60; START_S = (o.s|0)%60;
  upd();
};

// 反映ボタン（延長時間）
document.getElementById('setExtBtn').onclick=function(){
  var str=document.getElementById('extInput').value;
  var o=parseHMS(str);
  totalSec = hmsToSec(o); // これで途中からでもベースが変わる
  upd();
};

// 入力欄の値をとりあえず今の値で初期化
(function syncInputs(){
  document.getElementById('startInput').value = pad(START_H)+':'+pad(START_M)+':'+pad(START_S);
  document.getElementById('extInput').value = toHMS(totalSec);
})();


// 初期描画
upd();

function fmt(h,m,s){return h+':'+m+':'+s}

</script>
</body>
</html>
